## live_PushFlow（直播视频采集与推流模块）


直播分为以下几个模块：采集->处理->编码->推流->流分发->播放。

采集：使用摄像头采集视频；

处理：给采集到的帧画面进行美颜、滤镜、加水印等；

编码：采集到的原视频是非常大的，需要进行编码才能推给服务器，包括视频编码和音频编码，iOS一般使用VideoToolBox进行硬编码，编码标准通常使用H.264；

推流：推流一般使用RTMP协议，因为它的延迟最低，常用的流传输协议有RTMP、HLS、RTSP；

流分发：

播放：


使用AVFoundation框架进行视频音频采集，设置输出源的SampleBufferDelegate，就可以拿到每一帧画面进行处理；也可以直接使用GPUImage进行图像采集、滤镜设置和视频输出。

H.264协议：它定义了三种帧：I帧、P帧和B帧，它把几帧图像分为一组（GOP），通过内部算法，以I帧为基础预测P帧，再由I和P帧预测B帧，最后将I帧数据和预测的差值信息进行传输和存储。

H.264分为两层：视频编码层（VCL）和网络提取层（NAL）。上面说的是VCL，NAL是为了将VCL产生的比特字符串适配到各种网络环境中，它首先封装了图像参数集（PPS）、序列参数集（SPS），接着是I帧B帧P帧等数据。


#### 本地推流演示：
1. 安装Nginx服务器，参照[《安装Nginx服务器》](http://www.jianshu.com/p/53059be61546)，这篇文章只说明了Nginx配置文件对RTMP推流的支持，若需要HLS推流，参照[HLS推流配置](http://www.cnblogs.com/jys509/p/5653720.html)；

2. 安装ffmpeg，也参照[《安装Nginx服务器》](http://www.jianshu.com/p/53059be61546)这篇文章进行安装；

3. 现在就可以使用ffmpeg进行推流测试了，下载一个VLC播放器可以观看RTMP推流直播，打开Safari浏览器可观看HLS推流直播。
